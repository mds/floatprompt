/**
 * Dashboard Generator
 *
 * Creates /float/index.html — a human-readable overview
 * of all generated markdown files.
 */
/**
 * Generate the dashboard HTML
 */
export function generateDashboard(pages, options = {}) {
    const { siteTitle = 'Website', siteDescription = '', baseUrl = '' } = options;
    const generatedAt = new Date().toISOString().split('T')[0];
    const pageCount = pages.length;
    // Group pages by directory
    const groups = groupPagesByDirectory(pages);
    return `<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FloatPrompt Dashboard — ${escapeHtml(siteTitle)}</title>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.6;
      color: #1a1a1a;
      background: #fafafa;
      padding: 2rem;
      max-width: 800px;
      margin: 0 auto;
    }

    header {
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #e0e0e0;
    }

    h1 {
      font-size: 1.5rem;
      font-weight: 600;
      margin-bottom: 0.25rem;
    }

    .meta {
      color: #666;
      font-size: 0.875rem;
    }

    h2 {
      font-size: 1rem;
      font-weight: 600;
      margin: 1.5rem 0 0.75rem;
      color: #333;
    }

    ul {
      list-style: none;
    }

    li {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0;
      border-bottom: 1px solid #f0f0f0;
    }

    li:last-child {
      border-bottom: none;
    }

    a {
      color: #0066cc;
      text-decoration: none;
      flex: 1;
    }

    a:hover {
      text-decoration: underline;
    }

    .url {
      color: #888;
      font-size: 0.75rem;
      font-family: monospace;
    }

    button {
      background: #f5f5f5;
      border: 1px solid #ddd;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.75rem;
      cursor: pointer;
      color: #333;
    }

    button:hover {
      background: #eee;
    }

    button.copied {
      background: #d4edda;
      border-color: #c3e6cb;
      color: #155724;
    }

    .downloads {
      margin-top: 2rem;
      padding: 1rem;
      background: #f0f0f0;
      border-radius: 8px;
    }

    .downloads h2 {
      margin-top: 0;
    }

    .downloads a {
      display: inline-block;
      margin-right: 1rem;
    }

    footer {
      margin-top: 2rem;
      padding-top: 1rem;
      border-top: 1px solid #e0e0e0;
      color: #888;
      font-size: 0.75rem;
    }

    footer a {
      color: #888;
    }
  </style>
</head>
<body>
  <header>
    <h1>${escapeHtml(siteTitle)}</h1>
    <p class="meta">${pageCount} pages · Generated ${generatedAt}</p>
    ${siteDescription ? `<p class="meta">${escapeHtml(siteDescription)}</p>` : ''}
  </header>

  <main>
${generatePageGroups(groups, baseUrl)}
    <div class="downloads">
      <h2>Download All</h2>
      <a href="${baseUrl}/llms.txt">llms.txt</a>
      <a href="${baseUrl}/llms-full.txt">llms-full.txt</a>
    </div>
  </main>

  <footer>
    Generated by <a href="https://github.com/mds/floatprompt">FloatPrompt</a>
  </footer>

  <script>
    async function copyMarkdown(url, button) {
      try {
        const response = await fetch(url);
        const text = await response.text();
        await navigator.clipboard.writeText(text);

        const originalText = button.textContent;
        button.textContent = 'Copied!';
        button.classList.add('copied');

        setTimeout(() => {
          button.textContent = originalText;
          button.classList.remove('copied');
        }, 2000);
      } catch (err) {
        console.error('Failed to copy:', err);
        button.textContent = 'Error';
      }
    }
  </script>
</body>
</html>`;
}
/**
 * Generate HTML for page groups
 */
function generatePageGroups(groups, baseUrl) {
    const sections = [];
    for (const [groupName, pages] of Object.entries(groups)) {
        if (pages.length === 0)
            continue;
        const items = pages
            .map((page) => {
            const mdUrl = urlToMarkdownUrl(page.url, baseUrl);
            return `      <li>
        <a href="${mdUrl}">${escapeHtml(page.title)}</a>
        <span class="url">${escapeHtml(page.url)}</span>
        <button onclick="copyMarkdown('${mdUrl}', this)">Copy</button>
      </li>`;
        })
            .join('\n');
        sections.push(`    <h2>${escapeHtml(groupName)}</h2>
    <ul>
${items}
    </ul>`);
    }
    return sections.join('\n\n');
}
/**
 * Group pages by directory
 */
function groupPagesByDirectory(pages) {
    const groups = {
        Pages: [],
    };
    for (const page of pages) {
        const parts = page.url.split('/').filter(Boolean);
        if (parts.length === 0 || parts.length === 1) {
            groups['Pages'].push(page);
        }
        else {
            const groupKey = parts[0];
            const groupName = formatGroupName(groupKey);
            if (!groups[groupName]) {
                groups[groupName] = [];
            }
            groups[groupName].push(page);
        }
    }
    // Sort and filter empty groups
    const sortedGroups = {};
    if (groups['Pages'].length > 0) {
        sortedGroups['Pages'] = groups['Pages'];
    }
    const otherKeys = Object.keys(groups)
        .filter((k) => k !== 'Pages' && groups[k].length > 0)
        .sort();
    for (const key of otherKeys) {
        sortedGroups[key] = groups[key];
    }
    return sortedGroups;
}
/**
 * Format directory name as title
 */
function formatGroupName(name) {
    return name
        .split(/[-_]/)
        .map((word) => word.charAt(0).toUpperCase() + word.slice(1))
        .join(' ');
}
/**
 * Convert URL to markdown URL
 */
function urlToMarkdownUrl(url, baseUrl) {
    if (url === '/') {
        return baseUrl + '/index.md';
    }
    if (url.endsWith('/')) {
        return baseUrl + url + 'index.md';
    }
    return baseUrl + url + '.md';
}
/**
 * Escape HTML special characters
 */
function escapeHtml(text) {
    return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;')
        .replace(/"/g, '&quot;')
        .replace(/'/g, '&#039;');
}
//# sourceMappingURL=dashboard.js.map